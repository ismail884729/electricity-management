<div class="admin-users-container">
  <div class="page-header">
    <h1>User Management</h1>
    <p>Manage all registered users in the system</p>
  </div>

  <!-- Search and Filter Section -->
  <div class="search-section">
    <div class="search-bar">
      <input
        type="text"
        placeholder="Search users by name, email, or ID..."
        [(ngModel)]="searchTerm"
        (keyup.enter)="searchUsers()">
      <button class="search-btn" (click)="searchUsers()">Search</button>
    </div>
    <button class="add-user-btn" (click)="createUser()">Add New User</button>
  </div>

  <!-- User Form -->
  <div class="user-form-container" *ngIf="showUserForm">
    <h2>{{ isEditMode ? 'Edit User' : 'Add New User' }}</h2>
    <form (ngSubmit)="saveUser()">
      <div class="form-group">
        <label for="username">Username</label>
        <input type="text" id="username" [(ngModel)]="formUsername" name="username" required>
      </div>
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" [(ngModel)]="formEmail" name="email" required>
      </div>
      <div class="form-group">
        <label for="fullName">Full Name</label>
        <input type="text" id="fullName" [(ngModel)]="formFullName" name="fullName">
      </div>
      <div class="form-group">
        <label for="phoneNumber">Phone Number</label>
        <input type="text" id="phoneNumber" [(ngModel)]="formPhoneNumber" name="phoneNumber">
      </div>
      <div class="form-group" *ngIf="!isEditMode">
        <label for="password">Password</label>
        <input type="password" id="password" [(ngModel)]="formPassword" name="password" required>
      </div>
      <div class="form-group">
        <label for="role">Role</label>
        <select id="role" [(ngModel)]="formRole" name="role">
          <option value="user">User</option>
          <option value="admin">Admin</option>
        </select>
      </div>
      <div class="form-group">
        <label for="unitBalance">Unit Balance</label>
        <input type="number" id="unitBalance" [(ngModel)]="formUnitBalance" name="unitBalance">
      </div>
      <div class="form-group">
        <label>
          <input type="checkbox" [(ngModel)]="formIsActive" name="isActive">
          Active
        </label>
      </div>
      <div class="form-actions">
        <button type="submit" class="save-btn">{{ isEditMode ? 'Update' : 'Create' }}</button>
        <button type="button" class="cancel-btn" (click)="cancelForm()">Cancel</button>
      </div>
    </form>
  </div>

  <!-- Users Table -->
  <div class="users-table-container">
    <table class="users-table">
      <thead>
        <tr>
          <th>User ID</th>
          <th>Username</th>
          <th>Email</th>
          <th>Full Name</th>
          <th>Phone</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of filteredUsers">
          <td>{{ user.id }}</td>
          <td>{{ user.username }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.full_name }}</td>
          <td>{{ user.phone_number }}</td>
          <td>{{ user.role }}</td>
          <td>
            <span class="status-badge" [class.active]="user.is_active" [class.inactive]="!user.is_active" (click)="toggleUserStatus(user)">
              {{ user.is_active ? 'Active' : 'Inactive' }}
            </span>
          </td>
          <td>
            <button class="action-btn view" (click)="viewUserDetails(user)">View</button>
            <button class="action-btn edit" (click)="editUser(user)">Edit</button>
            <button class="action-btn delete" (click)="deleteUser(user)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination -->
    <div class="pagination">
        <button [disabled]="currentPage === 1" (click)="goToPage(currentPage - 1)">Previous</button>
        <span>Page {{ currentPage }}</span>
        <button (click)="goToPage(currentPage + 1)">Next</button>
      </div>
  </div>
</div>
