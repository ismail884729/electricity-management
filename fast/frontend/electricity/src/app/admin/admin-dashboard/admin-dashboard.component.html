<div class="admin-dashboard-container">
  <div *ngIf="!stats" class="loading-message">
    <p>Loading dashboard data...</p>
    <!-- You can add a spinner here if you have a CSS spinner class -->
  </div>

  <div *ngIf="stats">
    <div class="dashboard-header">
      <h1>Admin Dashboard</h1>
      <p>Overview of system performance and metrics</p>
      <div class="date-filter">
        <span>Date Range:</span>
        <select (change)="updateDateRange($event)">
          <option value="today">Today</option>
          <option value="yesterday">Yesterday</option>
          <option value="week" selected>This Week</option>
          <option value="month">This Month</option>
          <option value="quarter">This Quarter</option>
          <option value="year">This Year</option>
        </select>
      </div>
    </div>

  <!-- Key Metrics Section -->
  <div class="key-metrics-section">
    <div class="metric-card users">
      <div class="metric-icon">
        <i class="fas fa-users"></i>
      </div>
      <div class="metric-details">
        <h3>Total Users</h3>
        <p class="metric-value">{{ stats.total_users }}</p>
      </div>
    </div>

    <div class="metric-card devices">
      <div class="metric-icon">
        <i class="fas fa-plug"></i>
      </div>
      <div class="metric-details">
        <h3>Total Devices</h3>
        <p class="metric-value">{{ stats.total_devices }}</p>
      </div>
    </div>

    <div class="metric-card active-devices">
      <div class="metric-icon">
        <i class="fas fa-wifi"></i>
      </div>
      <div class="metric-details">
        <h3>Active Devices</h3>
        <p class="metric-value">{{ stats.active_devices }}</p>
      </div>
    </div>

    <div class="metric-card revenue">
      <div class="metric-icon">
        <i class="fas fa-dollar-sign"></i>
      </div>
      <div class="metric-details">
        <h3>Total Revenue</h3>
        <p class="metric-value">TSh {{ stats.total_revenue }}</p>
      </div>
    </div>

    <div class="metric-card consumption">
      <div class="metric-icon">
        <i class="fas fa-bolt"></i>
      </div>
      <div class="metric-details">
        <h3>Units Sold</h3>
        <p class="metric-value">{{ stats.units_sold }} kWh</p>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="dashboard-charts">
    <div class="chart-container consumption-chart">
      <h2>Electricity Consumption Trend</h2>
      <div class="chart-placeholder">
        <!-- In a real app, this would be a chart component -->
        <div class="chart-area">
          <div class="chart-bar" *ngFor="let value of consumptionData; let i = index"
               [style.height]="value + '%'"
               [attr.data-value]="value">
          </div>
        </div>
        <div class="chart-labels">
          <span *ngFor="let label of timeLabels">{{ label }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity Section -->
  <div class="recent-activity">
    <h2>Recent Transactions</h2>
    <table class="activity-table">
      <thead>
        <tr>
          <th>Transaction ID</th>
          <th>Device ID</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let transaction of recentTransactions">
          <td>{{ transaction.id }}</td>
          <td>{{ transaction.device_id }}</td>
          <td>TSh {{ transaction.amount }}</td>
          <td>{{ transaction.status }}</td>
          <td>{{ transaction.created_at | date: 'short' }}</td>
        </tr>
      </tbody>
    </table>
    <div class="view-all">
      <a routerLink="/admin/transactions">View All Transactions</a>
    </div>
  </div>
</div>
