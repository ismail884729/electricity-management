<div class="device-container">
  <div class="section-header">
    <h2>Device Details</h2>
  </div>

  <div *ngIf="isLoading" class="loading-container">
    <div class="loader-spinner"></div>
    <p>Loading device information...</p>
  </div>

  <div *ngIf="!isLoading && devices.length === 0" class="no-devices-container">
    <div class="no-devices-message">
      <i class="no-devices-icon">ðŸ“¡</i>
      <h3>No Devices Found</h3>
      <p>You don't have any devices registered yet. Please contact support to add devices to your account.</p>
      <button class="contact-support-btn" routerLink="/user/support">Contact Support</button>
    </div>
  </div>

  <div class="device-layout" *ngIf="!isLoading && devices.length > 0">
    <!-- Device List -->
    <div class="device-list">
      <h3>Your Devices</h3>
      <div class="device-list-items">
        <div *ngFor="let device of devices" 
             class="device-item" 
             [class.active]="selectedDevice && device.id === selectedDevice.id"
             (click)="selectDevice(device)">
          <div class="device-icon">
            <span>âš¡</span>
          </div>
          <div class="device-basic-info">
            <div class="device-name">{{ device.device_name }}</div>
            <div class="device-id">ID: {{ device.device_id }}</div>
            <div class="device-status" [ngClass]="{'active': device.is_online, 'inactive': !device.is_online}">
              {{ device.is_online ? 'Online' : 'Offline' }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Device Detail View -->
    <div class="device-detail-view" *ngIf="selectedDevice">
      <div class="device-header">
        <h3>{{ selectedDevice.device_name }} ({{ selectedDevice.device_id }})</h3>
        <div class="device-actions">
          <button class="device-action primary">Test Connection</button>
          <button class="device-action secondary">Reset Device</button>
        </div>
      </div>

      <div class="device-info-card">
        <div class="info-section">
          <h4>General Information</h4>
          <div class="info-grid">
            <div class="info-item">
              <div class="info-label">Device Name</div>
              <div class="info-value">{{ selectedDevice.device_name }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Device ID</div>
              <div class="info-value">{{ selectedDevice.device_id }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Is Primary</div>
              <div class="info-value">{{ selectedDevice.is_primary ? 'Yes' : 'No' }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Created At</div>
              <div class="info-value">{{ formatDate(selectedDevice.created_at) }}</div>
            </div>
          </div>
        </div>

        <div class="info-section">
          <h4>Device Status</h4>
          <div class="info-grid">
            <div class="info-item">
              <div class="info-label">Status</div>
              <div class="info-value status" [ngClass]="{'active': selectedDevice.is_online, 'inactive': !selectedDevice.is_online}">
                {{ selectedDevice.is_online ? 'Online' : 'Offline' }}
              </div>
            </div>
            <div class="info-item">
              <div class="info-label">Last Seen</div>
              <div class="info-value">{{ selectedDevice.last_seen ? formatDate(selectedDevice.last_seen) : 'N/A' }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Unit Balance</div>
              <div class="info-value">{{ selectedDevice.unit_balance }} kWh</div>
            </div>
            <div class="info-item">
              <div class="info-label">Signal Strength</div>
              <div class="info-value">{{ selectedDevice.signal_strength }}%</div>
            </div>
          </div>
        </div>

        <div class="device-readings-chart">
          <h4>Device Readings (Last 7 Days)</h4>
          <div class="chart-placeholder">
            <div class="chart-line"></div>
            <div class="chart-markers">
              <div class="chart-point" style="left: 10%; top: 70%"></div>
              <div class="chart-point" style="left: 25%; top: 50%"></div>
              <div class="chart-point" style="left: 40%; top: 60%"></div>
              <div class="chart-point" style="left: 55%; top: 30%"></div>
              <div class="chart-point" style="left: 70%; top: 45%"></div>
              <div class="chart-point" style="left: 85%; top: 20%"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
